/**!
 * RSA and ECC in JavaScript
 *
 * The jsbn library is a fast, portable implementation of large-number math
 * in pure JavaScript, enabling public-key crypto and other applications on desktop
 * and mobile browsers.
 *
 * @author	Tom Wu <tjw@cs.stanford.edu>
 * http://www-cs-students.stanford.edu/~tjw/jsbn/
 *
 * @build	lib/jsbn lib/prng4 lib/rnd lib/rsa lib/base64
 */
(function(G){function e(b,a,c){null!=b&&("number"==typeof b?this.fromNumber(b,a,c):null==a&&"string"!=typeof b?this.fromString(b,256):this.fromString(b,a))}function n(){return new e(null)}function H(b,a,c,d,h,i){for(;0<=--i;){var g=a*this[b++]+c[d]+h,h=Math.floor(g/67108864);c[d++]=g&67108863}return h}function I(b,a,c,d,h,i){for(var g=a&32767,a=a>>15;0<=--i;){var e=this[b]&32767,f=this[b++]>>15,j=a*e+f*g,e=g*e+((j&32767)<<15)+c[d]+(h&1073741823),h=(e>>>30)+(j>>>15)+a*f+(h>>>30);c[d++]=e&1073741823}return h}
function J(b,a,c,d,h,i){for(var e=a&16383,a=a>>14;0<=--i;){var f=this[b]&16383,j=this[b++]>>14,k=a*f+j*e,f=e*f+((k&16383)<<14)+c[d]+h,h=(f>>28)+(k>>14)+a*j;c[d++]=f&268435455}return h}function C(b){var a=n();a.fromInt(b);return a}function y(b){var a=1,c;if(0!=(c=b>>>16))b=c,a+=16;if(0!=(c=b>>8))b=c,a+=8;if(0!=(c=b>>4))b=c,a+=4;if(0!=(c=b>>2))b=c,a+=2;0!=b>>1&&(a+=1);return a}function m(b){this.m=b}function p(b){this.m=b;this.mp=b.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<
b.DB-15)-1;this.mt2=2*b.t}function z(){this.j=this.i=0;this.S=[]}function A(){var b=(new Date).getTime();l[j++]^=b&255;l[j++]^=b>>8&255;l[j++]^=b>>16&255;l[j++]^=b>>24&255;j>=B&&(j-=B)}function D(){}function E(b,a){for(var c="",d=0;d+a<b.length;)c+=b.substring(d,d+a)+"\n",d+=a;return c+b.substring(d,b.length)}function u(){this.n=null;this.e=0;this.coeff=this.dmq1=this.dmp1=this.q=this.p=this.d=null}function F(b){var a,c,d="";for(a=0;a+3<=b.length;a+=3)c=parseInt(b.substring(a,a+3),16),d+=s.charAt(c>>
6)+s.charAt(c&63);a+1==b.length?(c=parseInt(b.substring(a,a+1),16),d+=s.charAt(c<<2)):a+2==b.length&&(c=parseInt(b.substring(a,a+2),16),d+=s.charAt(c>>2)+s.charAt((c&3)<<4));for(;0<(d.length&3);)d+=K;return d}var f;"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=I,f=30):"Netscape"!=navigator.appName?(e.prototype.am=H,f=26):(e.prototype.am=J,f=28);e.prototype.DB=f;e.prototype.DM=(1<<f)-1;e.prototype.DV=1<<f;e.prototype.FV=Math.pow(2,52);e.prototype.F1=52-f;e.prototype.F2=2*f-52;var w=
[],k;f=48;for(k=0;9>=k;++k)w[f++]=k;f=97;for(k=10;36>k;++k)w[f++]=k;f=65;for(k=10;36>k;++k)w[f++]=k;m.prototype.convert=function(b){return 0>b.s||0<=b.compareTo(this.m)?b.mod(this.m):b};m.prototype.revert=function(b){return b};m.prototype.reduce=function(b){b.divRemTo(this.m,null,b)};m.prototype.mulTo=function(b,a,c){b.multiplyTo(a,c);this.reduce(c)};m.prototype.sqrTo=function(b,a){b.squareTo(a);this.reduce(a)};p.prototype.convert=function(b){var a=n();b.abs().dlShiftTo(this.m.t,a);a.divRemTo(this.m,
null,a);0>b.s&&0<a.compareTo(e.ZERO)&&this.m.subTo(a,a);return a};p.prototype.revert=function(b){var a=n();b.copyTo(a);this.reduce(a);return a};p.prototype.reduce=function(b){for(;b.t<=this.mt2;)b[b.t++]=0;for(var a=0;a<this.m.t;++a){var c=b[a]&32767,d=c*this.mpl+((c*this.mph+(b[a]>>15)*this.mpl&this.um)<<15)&b.DM,c=a+this.m.t;for(b[c]+=this.m.am(0,d,b,a,0,this.m.t);b[c]>=b.DV;)b[c]-=b.DV,b[++c]++}b.clamp();b.drShiftTo(this.m.t,b);0<=b.compareTo(this.m)&&b.subTo(this.m,b)};p.prototype.mulTo=function(b,
a,c){b.multiplyTo(a,c);this.reduce(c)};p.prototype.sqrTo=function(b,a){b.squareTo(a);this.reduce(a)};e.prototype.copyTo=function(b){for(var a=this.t-1;0<=a;--a)b[a]=this[a];b.t=this.t;b.s=this.s};e.prototype.fromInt=function(b){this.t=1;this.s=0>b?-1:0;0<b?this[0]=b:-1>b?this[0]=b+DV:this.t=0};e.prototype.fromString=function(b,a){var c;if(16==a)c=4;else if(8==a)c=3;else if(256==a)c=8;else if(2==a)c=1;else if(32==a)c=5;else if(4==a)c=2;else{this.fromRadix(b,a);return}this.s=this.t=0;for(var d=b.length,
h=!1,i=0;0<=--d;){var g;8==c?g=b[d]&255:(g=w[b.charCodeAt(d)],g=null==g?-1:g);0>g?"-"==b.charAt(d)&&(h=!0):(h=!1,0==i?this[this.t++]=g:i+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-i)-1)<<i,this[this.t++]=g>>this.DB-i):this[this.t-1]|=g<<i,i+=c,i>=this.DB&&(i-=this.DB))}8==c&&0!=(b[0]&128)&&(this.s=-1,0<i&&(this[this.t-1]|=(1<<this.DB-i)-1<<i));this.clamp();h&&e.ZERO.subTo(this,this)};e.prototype.clamp=function(){for(var b=this.s&this.DM;0<this.t&&this[this.t-1]==b;)--this.t};e.prototype.dlShiftTo=
function(b,a){var c;for(c=this.t-1;0<=c;--c)a[c+b]=this[c];for(c=b-1;0<=c;--c)a[c]=0;a.t=this.t+b;a.s=this.s};e.prototype.drShiftTo=function(b,a){for(var c=b;c<this.t;++c)a[c-b]=this[c];a.t=Math.max(this.t-b,0);a.s=this.s};e.prototype.lShiftTo=function(b,a){var c=b%this.DB,d=this.DB-c,h=(1<<d)-1,e=Math.floor(b/this.DB),g=this.s<<c&this.DM,f;for(f=this.t-1;0<=f;--f)a[f+e+1]=this[f]>>d|g,g=(this[f]&h)<<c;for(f=e-1;0<=f;--f)a[f]=0;a[e]=g;a.t=this.t+e+1;a.s=this.s;a.clamp()};e.prototype.rShiftTo=function(b,
a){a.s=this.s;var c=Math.floor(b/this.DB);if(c>=this.t)a.t=0;else{var d=b%this.DB,h=this.DB-d,e=(1<<d)-1;a[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)a[g-c-1]|=(this[g]&e)<<h,a[g-c]=this[g]>>d;0<d&&(a[this.t-c-1]|=(this.s&e)<<h);a.t=this.t-c;a.clamp()}};e.prototype.subTo=function(b,a){for(var c=0,d=0,e=Math.min(b.t,this.t);c<e;)d+=this[c]-b[c],a[c++]=d&this.DM,d>>=this.DB;if(b.t<this.t){for(d-=b.s;c<this.t;)d+=this[c],a[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<b.t;)d-=b[c],a[c++]=d&
this.DM,d>>=this.DB;d-=b.s}a.s=0>d?-1:0;-1>d?a[c++]=this.DV+d:0<d&&(a[c++]=d);a.t=c;a.clamp()};e.prototype.multiplyTo=function(b,a){var c=this.abs(),d=b.abs(),h=c.t;for(a.t=h+d.t;0<=--h;)a[h]=0;for(h=0;h<d.t;++h)a[h+c.t]=c.am(0,d[h],a,h,0,c.t);a.s=0;a.clamp();this.s!=b.s&&e.ZERO.subTo(a,a)};e.prototype.squareTo=function(b){for(var a=this.abs(),c=b.t=2*a.t;0<=--c;)b[c]=0;for(c=0;c<a.t-1;++c){var d=a.am(c,a[c],b,2*c,0,1);if((b[c+a.t]+=a.am(c+1,2*a[c],b,2*c+1,d,a.t-c-1))>=a.DV)b[c+a.t]-=a.DV,b[c+a.t+
1]=1}0<b.t&&(b[b.t-1]+=a.am(c,a[c],b,2*c,0,1));b.s=0;b.clamp()};e.prototype.divRemTo=function(b,a,c){var d=b.abs();if(!(0>=d.t)){var h=this.abs();if(h.t<d.t)null!=a&&a.fromInt(0),null!=c&&this.copyTo(c);else{null==c&&(c=n());var i=n(),g=this.s,b=b.s,f=this.DB-y(d[d.t-1]);0<f?(d.lShiftTo(f,i),h.lShiftTo(f,c)):(d.copyTo(i),h.copyTo(c));d=i.t;h=i[d-1];if(0!=h){var j=h*(1<<this.F1)+(1<d?i[d-2]>>this.F2:0),k=this.FV/j,j=(1<<this.F1)/j,l=1<<this.F2,r=c.t,m=r-d,q=null==a?n():a;i.dlShiftTo(m,q);0<=c.compareTo(q)&&
(c[c.t++]=1,c.subTo(q,c));e.ONE.dlShiftTo(d,q);for(q.subTo(i,i);i.t<d;)i[i.t++]=0;for(;0<=--m;){var p=c[--r]==h?this.DM:Math.floor(c[r]*k+(c[r-1]+l)*j);if((c[r]+=i.am(0,p,c,m,0,d))<p){i.dlShiftTo(m,q);for(c.subTo(q,c);c[r]<--p;)c.subTo(q,c)}}null!=a&&(c.drShiftTo(d,a),g!=b&&e.ZERO.subTo(a,a));c.t=d;c.clamp();0<f&&c.rShiftTo(f,c);0>g&&e.ZERO.subTo(c,c)}}}};e.prototype.invDigit=function(){if(1>this.t)return 0;var b=this[0];if(0==(b&1))return 0;var a=b&3,a=a*(2-(b&15)*a)&15,a=a*(2-(b&255)*a)&255,a=a*
(2-((b&65535)*a&65535))&65535,a=a*(2-b*a%this.DV)%this.DV;return 0<a?this.DV-a:-a};e.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};e.prototype.exp=function(b,a){if(4294967295<b||1>b)return e.ONE;var c=n(),d=n(),h=a.convert(this),f=y(b)-1;for(h.copyTo(c);0<=--f;)if(a.sqrTo(c,d),0<(b&1<<f))a.mulTo(d,h,c);else var g=c,c=d,d=g;return a.revert(c)};e.prototype.toString=function(b){if(0>this.s)return"-"+this.negate().toString(b);if(16==b)b=4;else if(8==b)b=3;else if(2==b)b=1;else if(32==
b)b=5;else if(4==b)b=2;else return this.toRadix(b);var a=(1<<b)-1,c,d=!1,e="",f=this.t,g=this.DB-f*this.DB%b;if(0<f--){if(g<this.DB&&0<(c=this[f]>>g))d=!0,e="0123456789abcdefghijklmnopqrstuvwxyz".charAt(c);for(;0<=f;)g<b?(c=(this[f]&(1<<g)-1)<<b-g,c|=this[--f]>>(g+=this.DB-b)):(c=this[f]>>(g-=b)&a,0>=g&&(g+=this.DB,--f)),0<c&&(d=!0),d&&(e+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(c))}return d?e:"0"};e.prototype.negate=function(){var b=n();e.ZERO.subTo(this,b);return b};e.prototype.abs=function(){return 0>
this.s?this.negate():this};e.prototype.compareTo=function(b){var a=this.s-b.s;if(0!=a)return a;var c=this.t,a=c-b.t;if(0!=a)return 0>this.s?-a:a;for(;0<=--c;)if(0!=(a=this[c]-b[c]))return a;return 0};e.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+y(this[this.t-1]^this.s&this.DM)};e.prototype.mod=function(b){var a=n();this.abs().divRemTo(b,null,a);0>this.s&&0<a.compareTo(e.ZERO)&&b.subTo(a,a);return a};e.prototype.modPowInt=function(b,a){var c;c=256>b||a.isEven()?new m(a):new p(a);
return this.exp(b,c)};e.ZERO=C(0);e.ONE=C(1);z.prototype.init=function(b){var a,c,d;for(a=0;256>a;++a)this.S[a]=a;for(a=c=0;256>a;++a)c=c+this.S[a]+b[a%b.length]&255,d=this.S[a],this.S[a]=this.S[c],this.S[c]=d;this.j=this.i=0};z.prototype.next=function(){var b;this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;b=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=b;return this.S[b+this.S[this.i]&255]};var B=256,x,l,j;if(null==l){l=[];j=0;if("Netscape"==navigator.appName&&"5">navigator.appVersion&&
window.crypto){k=window.crypto.random(32);for(f=0;f<k.length;++f)l[j++]=k.charCodeAt(f)&255}for(;j<B;)f=Math.floor(65536*Math.random()),l[j++]=f>>>8,l[j++]=f&255;j=0;A()}D.prototype.nextBytes=function(b){var a;for(a=0;a<b.length;++a){var c=b,d=a,e;if(null==x){A();x=new z;x.init(l);for(j=0;j<l.length;++j)l[j]=0;j=0}e=x.next();c[d]=e}};u.prototype.doPublic=function(b){return b.modPowInt(this.e,this.n)};u.prototype.setPublic=function(b,a){null!=b&&null!=a&&0<b.length&&0<a.length?(this.n=new e(b,16),
this.e=parseInt(a,16)):alert("Invalid RSA public key")};u.prototype.encrypt=function(b){var a;a=this.n.bitLength()+7>>3;if(a<b.length+11)alert("Message too long for RSA"),a=null;else{for(var c=[],d=b.length-1;0<=d&&0<a;){var f=b.charCodeAt(d--);128>f?c[--a]=f:127<f&&2048>f?(c[--a]=f&63|128,c[--a]=f>>6|192):(c[--a]=f&63|128,c[--a]=f>>6&63|128,c[--a]=f>>12|224)}c[--a]=0;b=new D;for(d=[];2<a;){for(d[0]=0;0==d[0];)b.nextBytes(d);c[--a]=d[0]}c[--a]=2;c[--a]=0;a=new e(c)}if(null==a)return null;a=this.doPublic(a);
if(null==a)return null;a=a.toString(16);return 0==(a.length&1)?a:"0"+a};var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K="=",t={modulus:0,exponent:"10001",seed:A,lineBreak:E,hex2Base64:F,encrypt:function(b,a,c){var d=new u;d.setPublic(a||t.modulus,c||t.exponent);return d.encrypt(b)},encrypt64:function(b,a,c){b=t.encrypt(b,a,c);return E(F(b))}};"undefined"!==typeof module&&module.exports?module.exports=t:G.RSA=t})(this);"undefined"!==typeof ajs&&ajs.loaded&&ajs.loaded("{rsa}RSA.min");
"function"===typeof define&&define.amd&&define("RSA",[],function(){return window.RSA||{}});